var currentMousePos={x:-1,y:-1};function addToLightboxButtonInit(){if($('.addToLightboxButton').length){$('.addToLightboxButton').unbind('click').click(function(event)
{event.preventDefault();if(!loggedIn){if(!$(this).closest('.media-details').length){workbox({'page':baseURL+'/workbox.php?mode=requireLoginLightbox',mini:true});}else{workboxLightbox({'page':baseURL+'/workbox.php?mode=requireLoginLightbox',mini:true});}}else{var mediaID=$(this).attr('mediaID');var elem=null;if(!$(this).closest('.media-details').length){elem=$('#addToLightboxButton'+mediaID);}else{elem=$('.media-details .addToLightboxButton');}
elem.find('.lightbox-loading').css("display","").next().hide();if(elem.attr('inLightbox')==1)
{var lightboxItemID=elem.attr('lightboxItemID');if(!$(this).closest('.media-details').length){workbox({page:baseURL+'/workbox.php?mode=editLightboxItem&lightboxItemID='+lightboxItemID+'&mediaID='+mediaID,mini:true,width:'500'});}else{workboxLightbox({page:baseURL+'/workbox.php?mode=editLightboxItem&lightboxItemID='+lightboxItemID+'&mediaID='+mediaID,mini:true,width:'500'},function(){elem.find('.lightbox-loading').css("display","none").next().show();});}}
else
{if(!$(this).closest('.media-details').length){workbox({page:baseURL+'/workbox.php?mode=addToLightbox&mediaID='+mediaID,mini:true,width:'500'});}else{workboxLightbox({page:baseURL+'/workbox.php?mode=addToLightbox&mediaID='+mediaID,mini:true,width:'500'},function(){elem.find('.lightbox-loading').css("display","none").next().show();});}}}});}}
$(function()
{if(parseInt($("#headerCartBox strong").text())>0){$("#cartLinks").show();}
$('#galleryListToggle').toggle(function()
{$('#galleryList').show();loadGalleriesTree();},function()
{$('#galleryList').hide();});$('.eyeGlass').click(function()
{$(this).closest('form').submit();});$('.backLink').click(function()
{goto($(this).attr('href'));});$('.messageBar').click(function()
{$(this).hide();});$('.assignToPackageButton').click(function(event)
{var mediaID=$(this).attr('mediaID');workbox({'page':baseURL+'/workbox.php?mode=assignPackage&mediaID='+mediaID});});$('.emailToFriend').click(function(event)
{var mediaID=$(this).attr('mediaID');workbox({'page':baseURL+'/workbox.php?mode=emailToFriend&mediaID='+mediaID,mini:true});});$(document).mouseover(function(){$('#hoverWindow').hide();});if(fadeInThumbnails.status){$('.mediaThumb').css('opacity',0);}
$('.mediaThumb').load(function()
{if(fadeInThumbnails.status)
{$(this).stop().animate({opacity:1.0},fadeInThumbnails.speed,function()
{$(this).parents('p').removeClass('loader1Center');});}
else
{$(this).show();$(this).parents('p').removeClass('loader1Center');}
setEquals('.mediaContainer');setEquals('.mediaThumbContainer');});$('.lightboxDelete').click(function(event)
{event.preventDefault();var pageX=event.pageX;var pageY=event.pageY;var lightboxID=$(this).attr('href');workbox({page:baseURL+'/workbox.php?mode=deleteLightbox&lightboxID='+lightboxID,mini:true});});$('.lightboxEdit').click(function(event)
{event.preventDefault();var pageX=event.pageX;var pageY=event.pageY;var lightboxID=$(this).attr('href');workbox({page:baseURL+'/workbox.php?mode=editLightbox&lightboxID='+lightboxID,mini:true,width:'500'});});$('#newLightbox').click(function(event)
{event.preventDefault();workbox({page:baseURL+'/workbox.php?mode=newLightbox',mini:true,width:'500'});});addToLightboxButtonInit();registerFollowCursor();$('#country').change(function()
{var countryID=$(this).val();getStateList(countryID);});$('.membershipWorkbox').click(function(event)
{event.preventDefault();var workboxPage=$(this).attr('href');workbox({page:workboxPage});});registerHoverFunction();var starCount=($(".starRating:first").find('.ratingStar').size());$(".starRating").each(function(key,elem)
{$(elem).hover('',function(){returnStarStatus(elem);});$(elem).find('.ratingStar').each(function(key2,elem2)
{var starValue=key2+1;if(starCount==5)
starValue=starValue*2;var mediaID=$(elem).attr('mediaID');$(elem2).css('cursor','pointer').mouseover(function(){highlightStars(elem,key2);}).click(function()
{$(elem).find('.ratingStar').unbind().css('cursor','default');$(elem).unbind().fadeOut(200,function()
{$.get(baseURL+'/actions.php',{action:'rateMedia',starValue:starValue,mediaID:mediaID},function(data)
{$(elem).html(data).fadeIn(200);});});});});});$('.pagingPageNumber').change(function()
{goto($(this).val());});$('.previous, .next').click(function(event)
{event.preventDefault();goto($(this).attr('href'));});$('.searchInputBox').click(function(){$(this).val('');});$('#languageSelector li').each(function()
{var aElement=$(this).find('a');var newLanguage=$(aElement).attr('href').split('setLanguage=');$(aElement).click(function(event){event.preventDefault();});$(this).click(function(){changeLanguage(newLanguage[1]);});});$('select#languageSelector').change(function()
{changeLanguage($(this).val());});$('#currencySelector li').each(function()
{var aElement=$(this).find('a');var newCurrency=$(aElement).attr('href').split('setCurrency=');$(aElement).click(function(event){event.preventDefault();});$(this).click(function(){changeCurrency(newCurrency[1]);});});$('select#currencySelector').change(function()
{changeCurrency($(this).val());});workboxLinksInit($('.workboxLink'));goToButton();});function workboxLinksInit(attachElm){attachElm.each(function()
{$(this).click(function(event){event.preventDefault();});var workboxPage=$(this).attr('href');var href=workboxPage.replace("http://","").replace("https://","").split("/");var profileID=href[2];var mediaID=href[3];switch(href[1]){case"digitals":var workboxLinkObj=$(this);var data={mode:"add",type:"digital",profileID:profileID,id:profileID,mediaID:mediaID,instantDownloadAvailable:"1",loggedIn:"",uniqueOrderID:uniqueOrderID};break;case"credits":var workboxLinkObj=$(this);var data={mode:"add",type:"credits",id:profileID,uniqueOrderID:uniqueOrderID};break;case"subscriptions":var workboxLinkObj=$(this);var data={mode:"add",type:"subscription",id:profileID,uniqueOrderID:uniqueOrderID};break;}
$(this).closest('.workboxLinkAttach').click(function()
{if(!loggedIn&&(href[1]=="credits"||href[1]=="subscriptions")){workbox({'page':baseURL+'/workbox.php?mode=requireLogin',mini:true});}else{workboxLinkObj.addClass("loading");var request=$.ajax({url:"/cart.php",type:"POST",data:data});request.done(function(cartpagedom){var elements=$(cartpagedom);var headerCartBox=$('header.main .cart-count',elements);$('header.main .cart-count').html(headerCartBox.html());workboxLinkObj.removeClass("loading");workboxLinkObj.parent().find('.success-msg').slideDown();});request.fail(function(jqXHR,textStatus){alert("Request failed: "+textStatus);});}});});}
function registerDG(dataGroup)
{$('#'+dataGroup.id+' .tabs li:first').addClass('selectedTab');$('#'+dataGroup.id+' .dataGroupContainer:first').show();$('#'+dataGroup.id+' .tabs li').click(function(event)
{$('#'+dataGroup.id+' .tabs li').removeClass('selectedTab');$(this).addClass('selectedTab');$('#'+dataGroup.id+' .dataGroupContainer').hide();$('#'+$(this).attr('container')).show();});}
function showLoader(elem,img)
{$(elem).html('<img src="'+imgPath+'/'+img+'" class="loaderGraphic" />');}
function hideLoader(elem)
{$(elem).html('');}
function vidWindowResize(player)
{var size=jwplayer(player).getMeta();$('#hoverMediaContainer').width(size.width);$('#hoverMediaContainer').height(size.height);}
function goToButton()
{$('.goToButton').unbind('click');$('.goToButton').click(function(event)
{event.preventDefault();goto($(this).attr('href'));});}
function correctRadios()
{$('.radioGroup').each(function()
{if(!$(this).children("input:radio:checked").val())
$(this).children("input:radio:first").attr("checked","checked");});}
function selectAllCheckboxes(items)
{$(items).each(function()
{$(this).attr("checked","checked");});}
function deselectAllCheckboxes(items)
{$(items).each(function()
{$(this).removeAttr("checked");});}
function checkRequired()
{var error=false;$('[require="require"]').each(function()
{if($(this).attr('type')=='checkbox')
{if(!$(this).is(':checked'))
{var element=$(this).attr('id');displayFormError('#'+element,'');error=true;return false;}}
else if($(this).attr('type')=='radio')
{var name=$(this).attr('name');var radioValue=$("input:radio[name='"+name+"']:checked").val()
if(radioValue==''||radioValue==0)
{var element=$(this).attr('id');displayFormError('#'+element,'');error=true;return false;}}
else
{if($(this).val()==''||$(this).val()==0)
{var element=$(this).attr('id');displayFormError('#'+element,'');error=true;return false;}}});if(error==true)
return true;else
return false;}
function loadGalleriesTree()
{$("#treeMenu").jstree({"json_data":{"ajax":{"url":baseURL+'/tree.data.php',"data":function(n){return{id:n.attr?n.attr("id"):0};},"success":function(){},"error":function(jqXHR,errorType,errorThrown)
{$('#treeMenu').html(jqXHR.responseText);}}},"core":{"animation":500,"initially_open":[],"html_titles":true},"plugins":["themes","json_data"],"themes":{"url":baseURL+"/assets/themes/"+theme+"/tree.css","dots":false,"icons":false}}).bind("loaded.jstree",function(e,data){if(autoExpandGalleryTree){$(this).jstree("open_all");}});}
function highlightStars(elem,current)
{$(elem).find('.ratingStar').each(function(key,elem2)
{if(current>=key)
$(elem2).attr('src',imgPath+'/star.1.png');else
$(elem2).attr('src',imgPath+'/star.0.png');});}
function returnStarStatus(elem)
{$(elem).find('.ratingStar').each(function(key,elem2)
{$(this).attr('src',imgPath+'/star.'+$(this).attr('originalStatus')+'.png');});}
function positionHoverWindow(elem)
{var hoverWindowWidth=$('#hoverWindow').outerWidth();var hoverWindowHeight=$('#hoverWindow').outerHeight();var thumbContainerWidth=$(elem).outerWidth();var thumbContainerHeight=$(elem).outerHeight();var offset=$(elem).offset();if(hoverWindow.followCursor==true)
{var offsetRightCheck=currentMousePos.x+hoverWindowWidth+80+hoverWindow.xOffset;var offsetBottomCheck=currentMousePos.y+hoverWindowHeight-$(window).scrollTop();if(offsetRightCheck>$(window).width())
var offsetLeft=currentMousePos.x-hoverWindowWidth-hoverWindow.xOffset;else
var offsetLeft=currentMousePos.x+50+hoverWindow.xOffset;if(offsetBottomCheck>$(window).height())
var offsetTop=($(window).height()+$(window).scrollTop())-hoverWindowHeight;else
var offsetTop=currentMousePos.y+hoverWindow.yOffset;}
else
{var offsetRightCheck=offset.left+hoverWindowWidth+thumbContainerWidth;var offsetBottomCheck=offset.top+hoverWindowHeight-$(window).scrollTop();if(offsetRightCheck>$(window).width())
var offsetLeft=offset.left-hoverWindowWidth-hoverWindow.xOffset;else
var offsetLeft=offset.left+thumbContainerWidth+hoverWindow.xOffset;if(offsetBottomCheck>$(window).height())
var offsetTop=($(window).height()+$(window).scrollTop())-hoverWindowHeight;else
var offsetTop=offset.top+hoverWindow.yOffset;}
$('#hoverWindow').css("top",offsetTop).css("left",offsetLeft);}
$(window).load(function()
{setTimeout(function(){$('.mediaThumb').stop().animate({opacity:1.0},fadeInThumbnails.speed);},fadeInThumbnails.speed);});var hoverWindowTimeout;function createHoverWindow(elem)
{clearTimeout(hoverWindowTimeout);hoverWindowTimeout=setTimeout(function(){fadeInHoverWindow(elem);},hoverWindow.delay);}
var hoverWindowRequest;function fadeInHoverWindow(elem)
{$('#hoverWindowInner').html('');hoverWindowRequest=$.get(baseURL+'/hover.php',{mediaID:$(elem).attr('mediaID')},function(data)
{$('#hoverWindowInner').html(data);setTimeout(function(){$(elem).parents('p').removeClass('loader1Center');},300);positionHoverWindow(elem);if(hoverWindow.fade)
$('#hoverWindow').fadeIn(hoverWindow.fadeSpeed);else
$('#hoverWindow').show();});hoverWindowRequest.complete(function()
{setTimeout(function()
{},100);});}
function overlay()
{$('#workbox').addClass("overlay");}
function workbox(workboxObj)
{if(!workboxObj.skipOverlay)
overlay();$('#workbox').html('').addClass('workboxLoader').fadeIn();if(workboxObj.mini)
{$('#workbox').removeClass('largeWorkbox');$('#workbox').addClass('miniWorkbox');}
else
{$('#workbox').removeClass('miniWorkbox');$('#workbox').addClass('largeWorkbox');var winScroll=$(window).scrollTop();$('#workbox').css({top:(winScroll+30)+"px"});var originalScroll=winScroll;$(window).scroll(function(event)
{var winScroll2=$(window).scrollTop();if(winScroll2<originalScroll)
{originalScroll=winScroll2;$('#workbox').css({top:(winScroll2+30)+"px"});}});}
if(workboxObj.page)
{$.get(workboxObj.page,'',function(data)
{$('#workbox').removeClass('workboxLoader').html(data);$('body').addClass("noscroll");$(document).ready(function(){workboxInit();});});}}
function workboxLightbox(workboxObj,callback)
{$('.workboxLightbox').html('').addClass('workboxLoader').fadeIn();if(workboxObj.mini)
{$('.workboxLightbox').removeClass('largeWorkbox');$('.workboxLightbox').addClass('miniWorkbox');}
else
{$('.workboxLightbox').removeClass('miniWorkbox');$('.workboxLightbox').addClass('largeWorkbox');var winScroll=$(window).scrollTop();$('.workboxLightbox').css({top:(winScroll+30)+"px"});var originalScroll=winScroll;$(window).scroll(function(event)
{var winScroll2=$(window).scrollTop();if(winScroll2<originalScroll)
{originalScroll=winScroll2;$('.workboxLightbox').css({top:(winScroll2+30)+"px"});}});}
if(workboxObj.page)
{$.get(workboxObj.page,'',function(data)
{$('.workboxLightbox').css("display","none").html(data).slideDown("slow",function(){workboxInit();callback();});});}}
function miniWorkbox(workboxObj)
{overlay();$('#miniWorkbox').html('').addClass('workboxLoader').show();if(workboxObj.page)
{$.get(workboxObj.page,'',function(data)
{$('#miniWorkbox').removeClass('workboxLoader').html(data);});}}
function closeWorkbox()
{$('#workbox').hide();$('#workbox').removeClass("overlay");$('.workboxLightbox').slideUp();$('#overlay').hide();$('body').removeClass("noscroll");}
function changeCurrency(newSetting)
{location.href=baseURL+'/actions.php?action=changeCurrency&setCurrency='+newSetting;}
function changeLanguage(newSetting)
{location.href=baseURL+'/actions.php?action=changeLanguage&setLanguage='+newSetting;}
function goto(gotolink)
{location.href=gotolink;}
function setEquals(id,parms)
{var maximum=0;if(!parms)var parms={};if(!parms.mode)parms.mode='min-height';$(id).each(function(key,elem)
{switch(parms.mode)
{default:case'min-height':case'height':var elemVal=$(elem).height();break;case'width':var elemVal=$(elem).width();break;}
if(elemVal>maximum)maximum=elemVal;});$(id).each(function(key,elem)
{$(elem).css(parms.mode,maximum+'px');});}
function updateOptionsCredits()
{if($('workboxItemCredits')&&$('#startingCredits').val())
{var newCredits=parseFloat($('#startingCredits').val());$('#workboxItemForm select').each(function(index,elem)
{newCredits=newCredits+Number($(elem).find('option:selected').attr('credits'));});$('#workboxItemForm input[type=checkbox]:checked').each(function(index,elem)
{if($(elem).attr('credits'))
newCredits=newCredits+parseFloat($(elem).attr('credits'));});$('#workboxItemForm input[type=radio]:checked').each(function(index,elem)
{if($(elem).attr('credits'))
newCredits=newCredits+Number($(elem).attr('credits'));});$('#workboxItemCredits').html(newCredits);}}
function updateOptionsPrice_old()
{if($('workboxItemPrice')&&$('#rawPrice').val())
{var newPrice=parseFloat($('#rawPrice').val());$('#workboxItemForm select').each(function(index,elem)
{newPrice=newPrice+Number($(elem).find('option:selected').attr('price'));});$('#workboxItemForm input[type=checkbox]:checked').each(function(index,elem)
{if($(elem).attr('price'))
newPrice=newPrice+parseFloat($(elem).attr('price'));});$('#workboxItemForm input[type=radio]:checked').each(function(index,elem)
{if($(elem).attr('price'))
newPrice=newPrice+Number($(elem).attr('price'));});newPrice=Math.round(newPrice*1000)/1000;newPrice=currency_display(newPrice,1);$('#workboxItemPrice').html(newPrice);}}
function updateOptionsPrice()
{if($('workboxItemPrice')&&$('#rawPrice').val())
{var newPrice=parseFloat($('#rawPrice').val());$('#workboxItemForm select').each(function(index,elem)
{newPrice=newPrice+Number($(elem).find('option:selected').attr('price'));});$('#workboxItemForm input[type=checkbox]:checked').each(function(index,elem)
{if($(elem).attr('price'))
newPrice=newPrice+parseFloat($(elem).attr('price'));});$('#workboxItemForm input[type=radio]:checked').each(function(index,elem)
{if($(elem).attr('price'))
newPrice=newPrice+Number($(elem).attr('price'));});if($('#taxInc').val())
newPrice=doTax(newPrice);newPrice=newPrice / numset.exchange_rate;newPrice=currency_display(newPrice,1);$('#workboxItemPrice').html(newPrice);}}
function doTax(price)
{var tax=(price*(numset.tax_a/100))+(price*(numset.tax_b/100))+(price*(numset.tax_c/100));price+=Math.round(tax*100)/100;return price;}
function getStateList(countryID,field)
{if(!field)field='state';if(countryID)
{$.ajax({type:'GET',url:'actions.php',data:{"action":"stateList","countryID":countryID},dataType:'json',success:function(data)
{var stateOptions;stateOptions+='<option value="0"></option>';$.each(data.states,function(key,state)
{stateOptions+='<option value='+key+'>'+state+'</option>';});$('#'+field).html(stateOptions);}});}}
function displayFormError(field,errorNum)
{$(field).addClass('formError');if(errorNum!='0')var errorMessage=$(field).attr('errorMessage'+errorNum);$(field).closest('div').addClass('formError');if(errorNum!='0')$(field).parent().append('<p class="formErrorMessage">'+errorMessage+'</p>');}
function registerHoverFunction()
{$(".showHoverWindow").hover(function()
{createHoverWindow($(this));if(hoverWindowRequest)hoverWindowRequest.abort();$(this).parents('p').addClass('loader1Center');if(dimThumbsOnHover.status)$(this).stop().animate({opacity:dimThumbsOnHover.toOpacity},dimThumbsOnHover.speed);},function()
{$('#hoverWindow').hide();$('#hoverWindowInner').html('');clearTimeout(hoverWindowTimeout);if(dimThumbsOnHover.status)
{$(this).parents('p').removeClass('loader1Center');$(this).stop().animate({opacity:1.0},dimThumbsOnHover.speed);}});}
function registerFollowCursor()
{if(hoverWindow.followCursor==true)
{$('.mediaThumb').mousemove(function(event)
{currentMousePos={x:event.pageX-20,y:event.pageY+20};positionHoverWindow($(this));});}}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=Base64._utf8_encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+
this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);}
return output;},decode:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));enc2=this._keyStr.indexOf(input.charAt(i++));enc3=this._keyStr.indexOf(input.charAt(i++));enc4=this._keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
output=Base64._utf8_decode(output);return output;},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;},_utf8_decode:function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}
else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}
else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;}}